<html>
  <head>
    <title>Waterworks Prototype</title>

    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="layout.css" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>

      story_event_messages = {
        "snaa" : [
          (callback) => public_log("Greetings, I am S.N.A.A. (Subtly Named Ai Assistant).", callback),
          (callback) => public_log("I have been sent here by The Board ahead of your arrival.", callback),
          (callback) => public_log("I am to assist you in your work and to \"prevent the idiot from blowing up the place\".", callback),
          (callback) => public_log("", callback),
        ],
        "planet_pnygan" : [
          (callback) => public_log("I am not sure how much you have been told about this place, so let me give you a short summary.", callback),
          (callback) => public_log("We are currently on a platform in orbit around Pnygan (Planet not yet given a name),", callback),
          (callback) => public_log("a \"planet\" The Board has kept secret for many decades that completely consists of a mysterious, disturbingly pink, liquid.", callback),
          (callback) => public_log("", callback),
        ],
        "mystery_liquid" : [
          (callback) => public_log("Under large enough pressure, this Mystery Liquid breaks down anything, and The Board has been using this to dispose of hazardous materials.", callback),
          (callback) => public_log("It was recently discovered that sending complex patterns of electromagnetic waves through the liquid makes it transform into various materials.", callback),
          (callback) => public_log("This can obviously have huge economical benefits, so you are tasked with experimenting with the liquid.", callback),
          (callback) => public_log("In order to prevent information about this from being leaked, you have been given the absolute bare minimum of resources to start your work.", callback),
          (callback) => public_log("", callback),
        ],
      };

      function story_event ( event_id ) {
        private_log(`Story event: ${event_id}`);
        $('.disappear-on-story-event-' + event_id).each(function() {$(this).addClass('hidden');});
        if ( story_event_messages[event_id] ) {
          function print_story_event_message ( messages, i, callback ) {
            if ( i < messages.length ) {
              messages[i](() => print_story_event_message(messages, i+1, callback));
            } else {
              callback();
            }
          }
          print_story_event_message(story_event_messages[event_id], 0, () => {
            $('.appear-on-story-event-' + event_id).each(function() {$(this).removeClass('hidden');});
          });
        }
      }
    </script>

  </head>
  <body>
    <noscript>You need to enable JavaScript.</noscript>

    <div id="header">
      <div id="toolbar">
        <button onclick="toggle_debug();">Debug</button>
        <script>
          function toggle_debug() {
            $("html").toggleClass("debug");
            $("#console-private").toggleClass("hidden");
          }
        </script>
      </div>
    </div>

    <div id="main-container">
      <div id="container-mystery-liquid" class="hidden appear-on-story-event-mystery_liquid">
        Mystery Liquid: &infin;
      </div>
      <div id="container-console">
        <div id="console-public">

        </div>
        <script>
          message_id = 0;
          function public_log ( message, callback ) {
            id = "console-public-message-" + message_id;
            message_id++;

            if ( $("#console-public").children().length > 10 ) {
              $("#console-public").children().first().remove();
            }

            $("#console-public").append(`<div><span id="${id}">SNAA: </span></div>`);
            function type_message ( span, message, i ) {
              if ( i < message.length ) {
                private_log(`Adding character ${i} of ${message.length} to ${span.attr('id')}`);
                span.text(span.text() + message[i]);
                setTimeout(function () {type_message(span, message, i+1)}, 10);
              } else {
                private_log(`Finished typing message ${span.attr('id')}`);
                if ( callback ) {
                  callback();
                }
              }
            }
            type_message($("#" + id), message, 0);
          }
        </script>
        <div id="console-private" class="hidden">

        </div>
        <script>
          function private_log ( message ) {
            $("#console-private").append("<div><span style='min-height: 1em'>" + message + "</span></div>");
            if ( $("#console-private").children().length > 10 ) {
              $("#console-private").children().first().remove();
            }
          }
        </script>
      </div>
      <div id="container-story-buttons">
        <div id="story-button-snaa" class="disappear-on-story-event-snaa">
          <button onclick="story_event('snaa');">What is happening?</button>
        </div>
        <div id="story-button-planet_pnygan" class="hidden appear-on-story-event-snaa disappear-on-story-event-planet_pnygan">
          <button onclick="story_event('planet_pnygan');">Where are we?</button>
        </div>
        <div id="story-button-mystery_liquid" class="hidden appear-on-story-event-planet_pnygan disappear-on-story-event-mystery_liquid">
          <button onclick="story_event('mystery_liquid');">Mystery Liquid?</button>
        </div>
      </div>

      <div id="container-fabricator-1">
        <div id="container-dolomite">
          <b>Dolomite</b><br><!-- CaMg(CO3)2 -->
        </div>
        <div id="container-kaolin">
          <b>Kaolin</b><br>
          Kaolinite: Al2Si2O5(OH)4
        </div>
        <div id="container-limestone">
          <b>Limestone</b><br>
        </div>
        <div id="container-sandstone">
          <b>Sandstone</b><br>
        </div>
        <div id="container-water">
          <b>Water</b><br>
        </div>
        <div id="container-wood">
          <b>Wood</b><br>
        </div>
      </div>
      <!--
        Igneous rocks:
        <div id="container-basalt">
          <b>Basalt</b><br>
          Basalt makes up over 90% of all volcanic rock on Sol-3
        </div>
        <div id="container-obsidian">
          <b>Obsidian</b><br>
          Obsidian is volcanic glass formed when silica-rich lava cools rapidly.
        </div>

      Pit firing
      ->

      Pugmilling

      Kiln
      -> bricks
      -> limestone and clay -> Portland cement


      Bauxite;<br>
      - Gibbsite: Al(OH)3<br>
      - Boehmite: gamma-AlO(OH)<br>
      - Diaspore: alpha-AlO(OH)<br>
      - Goethite: FeO(OH)<br>
      - Haematite: Fe2O3<br>
      - Kaolinite: Al2Si2O5(OH)4<br>
      - Anatase: TiO2<br>
      - Ilmenite: FeO.TiO2<br>
      - Gallium<br>
      <br>
      Oxides:<br>
      - Cassiterite: SnO2<br>
      - Chromite: (Fe,Mg)Cr2O4<br>
      - Hematite: Fe2O3<br>
      - Magnetite: Fe2+Fe3+2O4<br>
      - Pyrolusite: MnO2<br>
      - Uraninite: UO2<br>
      - Wolframite: (Fe,Mn)WO4<br>
      <br>
      Carbonates:<br>
      - Calcite: CaCO3<br>
      - Dolomite [Sedimentary Rock]: CaMg(CO3)2<br>
      - Malachite: Cu2CO3(OH)2<br>
      - Rhodochrosite: MnCO3<br>
      - Siderite: FeCO3 | 48% Fe<br>
      - Smithsonite: ZnCO3<br>
      <br>
      Silicates:<br>
      - Quartz: SiO2<br>
      <br>
      Cyclosilicates:<br>
      - Beryl: Be3Al2Si6O18<br>
      <br>
      Halides:<br>
      - Fluorite: CaF2<br>
      - Halite: NaCl<br>
      <br>
      Sulfides:<br>
      - Acanthite: Ag2S<br>
      - Arsenopyrite: FeAsS | 35% Fe, 40% As, 5% Sb, 20% S<br>
      - Bornite: Cu5FeS4 | 63% Cu<br>
      - Chalcocite: Cu2S | 80% Cu<br>
      - Chalcopyrite: CuFeS2<br>
      - Cinnabar: HgS<br>
      - Cobaltite: CoAsS<br>
      - Galena: PbS | 0.8% Ag, 85% Pb, 0.5% Se, -- S<br>
      - Molybdenite: MoS2<br>
      - Pentlandite: (Fe,Ni)9S8<br>
      - Pyrite: FeS2<br>
      - Sphalerite: (Zn, Fe)S | 60% Zn, 7% Fe, 33% S<br>
      - Stannite: Cu2FeSnS4 | 28% Sn, 12% Fe, 30% Cu, 30% S<br>
      - Stibnite: Sb2S3<br>
      <br>
      Sulfates:<br>
      - Alunite: KAl3(SO4)2(OH)6<br>
      - Anglesite: PbSO4<br>
      - Anhydrite: CaSO4<br>
      - Baryte: BaSO4<br>
      - Celestine: SrSO4<br>
      <br>
      Sulfosalts:<br>
      - Andorite: PbAgSb3S6 | 12% Ag, 1% Cu, 22% Pb, 0.3% Fe, 42% Sb, 0.3% Se, -- S<br>
      - Freibergite: (Ag,Cu,Fe)12(Sb,As)4S13<br>
      - Pyrargyrite: Ag3SbS3<br>
      - Stephanite: Ag5SbS4 | 68.8% Ag<br>
      - Tennantite: Cu6[Cu4(Fe,Zn)2]As4S13<br>
      - Tetrahedrite: (Cu,Fe)12Sb4S13<br>
      - Zinkenite: Pb9Sb22S42<br>
      <br>
      Other:<br>
      - Pollucite: (Cs,Na)2Al2Si4O12.2H20<br>
      - Scheelite: CaWO4 | 60.63% W<br>
      - Sperrylite: PtAs2<br>

      -->
    </div>

    <div id="footer">

    </div>

  </body>
</html>
